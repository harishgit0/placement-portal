{% extends "base_student.html" %}

{% block title %}Dashboard{% endblock %}

{% block content %}

<!-- Header with Back button -->
<div class="d-flex justify-content-between align-items-center mb-4">
    <h4 class="fw-semibold mb-0">Placement Drives</h4>

    <a href="{{ url_for('student_company') }}" class="btn btn-outline-secondary btn-sm">
        ← Back
    </a>
</div>

<div class="row g-4">
{% for drive in drives %}
    <div class="col-md-6">
        <div class="card shadow-sm border-0 h-100">
            <div class="card-body d-flex flex-column">

                <h5 class="card-title fw-semibold mb-2">
                    {{ drive.company.company_name }}
                </h5>

                <p class="card-text mb-1">
                    <strong>Job Title:</strong> {{ drive.job_title }}
                </p>

                <p class="card-text text-muted small mb-2">
                    <strong>Job Description:</strong>
                    {{ drive.job_description[:120] }}
                    {% if drive.job_description and drive.job_description|length > 120 %}…{% endif %}
                </p>

                <p class="card-text mb-1">
                    <strong>Eligibility:</strong> {{ drive.eligibility }}
                </p>

                <p class="card-text mb-3">
                    <strong>Deadline:</strong>
                    {{ drive.deadline.strftime('%d %b %Y') if drive.deadline else 'N/A' }}
                </p>

                <!-- Status + Action -->
                <div class="d-flex justify-content-between align-items-center mt-auto">
                    <div>
                        <strong>Status:</strong>
                        {% if drive.status == 'Approved' %}
                            <span class="badge bg-success ms-1">Approved</span>
                        {% else %}
                            <span class="badge bg-secondary ms-1">{{ drive.status }}</span>
                        {% endif %}
                    </div>

                    {% if drive.status in ['Approved', 'Open'] %}

                        <form method="POST" action="{{ url_for('student_apply', drive_id=drive.id) }}">
                            <button type="submit" class="btn btn-primary">
                                Apply
                            </button>
                        </form>


                    {% endif %}
                </div>

            </div>
        </div>
    </div>
{% else %}
    <div class="col-12 text-center text-muted py-5">
        No placement drives available at the moment.
    </div>
{% endfor %}
</div>

{% endblock %}
